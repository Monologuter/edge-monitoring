<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.safetyfire.monitor.mapper.AiBoxAlarmActionIngestMapper">

    <resultMap id="AiBoxAlarmActionIngestMap" type="com.safetyfire.monitor.domain.entity.AiBoxAlarmActionIngestEntity">
        <id column="id" property="id"/>
        <result column="device_serial" property="deviceSerial"/>
        <result column="alarm_type" property="alarmType"/>
        <result column="alarm_time_ms" property="alarmTimeMs"/>
        <result column="raw_payload" property="rawPayload"/>
    </resultMap>

    <insert id="insert" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO ai_box_alarm_action_ingest (device_serial, alarm_type, alarm_time_ms, raw_payload, created_at, updated_at)
        VALUES (#{deviceSerial}, #{alarmType}, #{alarmTimeMs}, #{rawPayload}, NOW(3), NOW(3))
    </insert>

    <select id="findById" resultMap="AiBoxAlarmActionIngestMap">
        SELECT id, device_serial, alarm_type, alarm_time_ms, raw_payload
        FROM ai_box_alarm_action_ingest
        WHERE id = #{id}
        LIMIT 1
    </select>

</mapper>

